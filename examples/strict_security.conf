# Personal Firewall Strict Security Configuration
# Maximum security - only allow absolutely necessary traffic

[general]
chain=INPUT
policy=DROP
logging=enabled
log_file=/var/log/personal-firewall.log

[rules]
# Allow loopback
1. action=ACCEPT, source=127.0.0.1, comment="Allow localhost only"

# Allow established and related connections
2. action=ACCEPT, source=0.0.0.0/0, comment="Allow established connections"

# SSH only from specific trusted IP
3. action=ACCEPT, protocol=TCP, port=22, source=TRUSTED_IP_HERE, comment="Allow SSH from trusted IP only"

# Block all other SSH attempts
4. action=DROP, protocol=TCP, port=22, comment="Block all other SSH"

# Allow minimal web traffic if needed
5. action=ACCEPT, protocol=TCP, port=80, comment="Allow HTTP"
6. action=ACCEPT, protocol=TCP, port=443, comment="Allow HTTPS"

# Drop invalid packets
7. action=DROP, comment="Drop invalid packets"

# Block common attack ports
8. action=DROP, protocol=TCP, port=23, comment="Block telnet"
9. action=DROP, protocol=TCP, port=135, comment="Block RPC"
10. action=DROP, protocol=TCP, port=139, comment="Block NetBIOS"
11. action=DROP, protocol=TCP, port=445, comment="Block SMB"
12. action=DROP, port=1433, comment="Block SQL Server"
13. action=DROP, port=3306, comment="Block MySQL"
14. action=DROP, port=5432, comment="Block PostgreSQL"

# Block UDP except essential
15. action=DROP, protocol=UDP, comment="Block most UDP"

# Log all dropped connections for analysis
16. action=DROP, comment="Log all blocked traffic"

